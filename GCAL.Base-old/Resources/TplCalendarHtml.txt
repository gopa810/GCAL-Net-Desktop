<html>
    <head>
        <title>Calendar [calendar.startDate.year]</title>
<style>
<!--
body {
  font-family:Verdana;
  font-size:11pt;
}
td.hed {
  font-family:Verdana;
  font-size:9pt;
  font-weight:bold;
  background:#aaaaaa;
  color:white;
  text-align:center;
  vertical-align:center;
  padding-left:15pt;
  padding-right:15pt;
  padding-top:5pt;
  padding-bottom:5pt;
}
-->
</style>

</head>
<body>

# (set lastmonth -1)
# (set lastmasa -1)
# (foreach i : calendar.itemIndexes
#     (set pvd (x calendar getDay i))
#     (set nMasaHeader 0)
#     (if (and (eq (x app calendarHeaderType) 0) (!= pvd.astro.masa lastmasa)) then
#        (if (ne lastmasa -1) then
   </table>
#        )
<p style='text-align:center'>
    <span style='font-weight:bold;font-size:14pt'>
         [pvd.astro.masaName] Masa, Gaurabda [pvd.astro.gaurabdaYear]
    </span>

#         (if (and (eq pvd.astro.masa 12) (>= lastmasa 3) (<= lastmasa 6)) then
    <br>(Caturmasya is not observed during Purusottama Adhika Masa.)
#         )
#         (set lastmasa pvd.astro.masa)
#         (set nMasaHeader 1)
#     )
#     (if (and (eq (x app calendarHeaderType) 1) (!= pvd.date.month lastmonth)) then
#         (set lastmonth pvd.date.month)
#            (if (ne lastmonth -1) then
   </table>
#            )

<p style='text-align:center'>
    <span style='font-weight:bold;font-size:14pt'>
         [pvd.date.monthName] [pvd.date.year]
	</span>
#         (set nMasaHeader 1)
#     )
#     (if (== nMasaHeader 1) then
#         (set tmp (x app centerText location.fullName 80))
<br>[tmp]
</p>
<table align=center>
  <tr>
    <td class=hed colspan=2>DATE</td>
    <td class=hed>TITHI</td>
#         (if (x app getDispValue 39) then (print "<td class=hed>PAKSA</td>"))
#         (if (x app getDispValue 37) then (print "<td class=hed>YOGA</td>"))
#         (if (x app getDispValue 36) then (print "<td class=hed>NAKSATRA</td>"))
#         (if (x app getDispValue 38) then (print "<td class=hed>FAST</td>"))
#         (if (x app getDispValue 41) then (print "<td class=hed>RASI</td>"))
  </tr>

#     )
#     (if (or (== (x app getDispValue 20) 0) (> pvd.visibleEvents.count 0)) then
#         (if (< pvd.astro.sunLongitude 0.0) then
<tr><td colspan=2><td colspan=2> No sunrise and no sunset for this day</td></tr>
#         else
<tr style='background:beige'><td>[pvd.date.shortDate]</td>
    <td>[pvd.date.dayOfWeekAbbr]</td>
	<td>[pvd.tithiNameExt]</td>
#             (if (x app getDispValue 39) then 
    <td>[pvd.astro.paksaAbbr]</td>
#             )
#             (if (x app getDispValue 37) then 
    <td>[pvd.astro.yogaName]</td>
#             )
#             (if (x app getDispValue 36) then
    <td>[pvd.astro.naksatraName]</td>
#             )
#             (if (x app getDispValue 38) then 
#                 (if (!= pvd.fastType 0) then
    <td> * </td>
#                 else 
    <td> </td>
#                 )
#             )
#             (if (x app getDispValue 41) then 
    <td>[pvd.astro.moonRasiName]</td>
#             )
</tr>

#             (if (> pvd.visibleEvents.count 0) then
  <tr>
  <td colspan=2><td colspan=4>
#                 (foreach ed : pvd.visibleEvents
#                         (if ed.isSpec then
#                             (set tmp (x app centerText ed.text 80 '-))
  <span style='color:[ed.specTextColor]'>[tmp]</span>
#                          else
  [ed.htmlText]
  <br />
#                         )
#                 )
  </td>
  </tr>
#             )
#         )
#     )
# )

</table>

<hr>
<p><b>Notes:</b>
<br>
<br>DST - Time is in 'Daylight Saving Time'
<br>LT  - Time is in 'Local Time'
</br>
</br>Generated by [app.versionName]

</body>
</html>

